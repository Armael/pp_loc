<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Input (pp_loc.Pp_loc.Input)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">pp_loc</a> &#x00BB; <a href="../index.html">Pp_loc</a> &#x00BB; Input</nav><header class="odoc-preamble"><h1>Module <code><span>Pp_loc.Input</span></code></h1><p>Abstraction over the input containing the input to read from.</p></header><nav class="odoc-toc"><ul><li><a href="#high-level-functions">High-level functions</a></li><li><a href="#low-level-functions">Low-level functions</a></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> t</span></code></div><div class="spec-doc"><p>The abstract input type. Informally, an &quot;input&quot; of type <code>t</code> should support:</p><ul><li>seeking the cursor to a given initial position (as a number of bytes)</li><li>from this position, read the input byte per byte</li></ul></div></div><h3 id="high-level-functions"><a href="#high-level-functions" class="anchor"></a>High-level functions</h3><div class="odoc-spec"><div class="spec value" id="val-file" class="anchored"><a href="#val-file" class="anchor"></a><code><span><span class="keyword">val</span> file : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>file fname</code> is an input that corresponds to the content of the file named <code>fname</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-string" class="anchored"><a href="#val-string" class="anchor"></a><code><span><span class="keyword">val</span> string : <span>string <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>string s</code> is an input that corresponds to the content of the string <code>s</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-bytes" class="anchored"><a href="#val-bytes" class="anchor"></a><code><span><span class="keyword">val</span> bytes : <span>bytes <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>bytes b</code> is an input that corresponds to the content of the bytes array <code>b</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-in_channel" class="anchored"><a href="#val-in_channel" class="anchor"></a><code><span><span class="keyword">val</span> in_channel : <span><span class="xref-unresolved">Stdlib</span>.in_channel <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>in_channel cin</code> is an input that correspond to the input channel <code>cin</code>. The channel must correspond to a file: it must be possible to call <code>seek_in</code> on the channel without error.</p><p>Creating an input using <code>in_channel</code> instead of <code>file</code> is more efficient if one needs to perform successive calls of <code>Pp_loc.pp</code> on the same input. Otherwise (or if having the best performance is not important), it is simpler (and thus recommended) to use <code>file</code>.</p></div></div><h3 id="low-level-functions"><a href="#low-level-functions" class="anchor"></a>Low-level functions</h3><div class="odoc-spec"><div class="spec value" id="val-raw" class="anchored"><a href="#val-raw" class="anchor"></a><code><span><span class="keyword">val</span> raw : 
  <span>seek:<span>( <span>int <span class="arrow">&#45;&gt;</span></span> <span><span>( unit, <span>[ `Invalid_position ]</span> )</span> <span class="xref-unresolved">Stdlib</span>.result</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>read_char:<span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>( char, <span>[ `End_of_input ]</span> )</span> <span class="xref-unresolved">Stdlib</span>.result</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>line_offsets:<span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <span>int array</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p>Creates an input from functions.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">seek</span> <p>a function to move to a given offset in the input. A call to <code>seek</code> will come before any call to <code>read_char</code>. If the call to <code>seek</code> fails and returns <code>Error `Invalid_position</code>, the input is considered to be unreadable and will be treated equivalenty as the empty input. This might happen even if the input is valid, if one tries to highlight an invalid location.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">read_char</span> <p>used to read the next char from the currently seeked position, and seek one char forward.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">line_offsets</span> <p>computes the byte offset of each line in the file. This is used when positions are built from only an offset, or only a pair <code>(line,column)</code>.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-managed" class="anchored"><a href="#val-managed" class="anchor"></a><code><span><span class="keyword">val</span> managed : <span><span>( <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a> * <span>( <span>unit <span class="arrow">&#45;&gt;</span></span> unit )</span> )</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-t">t</a></span></code></div><div class="spec-doc"><p><code>managed f</code> enables creating an input which lifetime is managed explicitely. In other words, it handles inputs with explicit open and close operations.</p><p>For instance, a file (which needs to be explicitely opened then close) is an instance of <code>managed</code>.</p><p>If <code>f()</code> returns <code>(i, c)</code>, then using the input <code>managed f</code> will first call <code>f()</code> to access the underlying input <code>i</code>, and will terminate by calling <code>c ()</code>.</p></div></div></div></body></html>